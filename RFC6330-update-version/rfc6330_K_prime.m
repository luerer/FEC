% Copyright (c) 2013, Ravichandran
% All rights reserved.
% 
% Redistribution and use in the source code, with or without 
% modification, are permitted provided that the following conditions are 
% met:
% 
%     * Redistributions of source code must retain the above copyright 
%       notice, this list of conditions and the following disclaimer.
%           
% THIS SOURCE CODE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED 
% TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
% CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
% PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
% WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN 
% IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


function K_prime = rfc6330_K_prime( K )
%
% Calculates K_prime for zero padding given the number of source symbols
%
% Input:
%        K - number of source symbols
% Output:
%  K_prime - number of symbols of the extended source block
%
if ((K<1)||(K>56403))
    error('Number of symbols K out of bounds!')
end
K_prime_table = [10,12,18, 20, 26,30, 32,  36,42, 46, 48, 49, 55,...
    60,62, 69,75,84, 88,  91,  95, 97,101, 114,119, 125, 127,138,140, 149,153,160,...
    166,168, 179,181, 185,187,200, 213, 217, 225,236, 242,248,257, 263,269, ...
    280,295,301,305,324, 337,341,347, 355,362, 368,372,380,385,393, 405,418,428,434,447,...
    453, 466, 478, 486,491,497, 511, 526, 532, 542,549,557,563,573, 580,588,594,600,606, 619,633,... 
    640,648, 666,675,685,693,703,718,728,736, 747,759,778,792,802, 811,821,835, 845,860,870, 891,903,... 
    913,926,938,950,963,977,989,1002,1020,1032,1050,1074,1085,1099,1111,1136,1152,1169,1183,1205,1220,... 
   1236,1255,1269, 1285,1306,1347, 1361, 1389,1404,1420, 1436,1461,1477, 1502,1522, 1539,1561,1579, 1600,... 
   1616, 1649, 1698,1716,1734,1759, 1777,1800,1824,1844, 1863,1887,1906, 1926, 1954,1979,2005,2040,2070,... 
   2103,2125,2152, 2195,2217,2247,2278,2315,2339, 2367,2392,2416,2447, 2473,2502,2528,2565,2601,2640,2668,... 
   2701,2737,2772, 2802,2831,2875,2906,2938,2979,3015, 3056, 3101,3151,3186,3224,3265, 3299,3344,3387,3423,...
   3466, 3502,3539, 3579,3616,3658,3697,3751,3792,3840, 3883,3924, 3970,4015,4069, 4112,4165,4207,4252,4318,... 
   4365,4418,4468, 4513,4567,4626,4681,4731,4780,4838,4901,4954,5008,5063,5116,5172,5225,5279,5334,5391,5449,...
   5506,5566,5637,5763,5823,5896,5975, 6039,6102,6169, 6233,6296,6363,6427,6518,6589,6655,6730, 6799,6878,6956,7033,7108,... 
   7185, 7281,7360,7445,7520,7596,7675,7770,7855,7935,8030,8111,8194,8290,8377,8474,8559,8654,8744,8837,8928,9019,9111,9206,... 
   9303,9400,9497,9601,9813,9916,10017,10120,10241,10351,10458,10567,10676,10787,10899,11015,11130,11245,11358,11475,11590,11711,... 
   11829,11956,12087,12208,12333,12460,12593,12726,12857,13002,13143,13284,13417,13558,13695,13833,13974,14115,14272, 14415,14560,... 
   14713,14862,15011,15170,15325,15496,15651,15808,15977, 16161,16336,16505,16674,16851,17024,17195,17376,17559,17742,17929,18116,... 
   18309,18503,18694,18909,19126,19325,19539,19740,19939,20152,20355,20564,20778,20988,21199,21412,21629,21852,22073,22301,22536,...
   22779,23010,23252,23491,23730,23971,24215,24476,24721,24976,25230, 25493,25756,26022,26291,26566,26838,27111,27392,27682,27959,...
   28248,28548, 28845,29138,29434,29731,30037,30346,30654,30974,31285,31605,31948,32272,32601,32932,33282,33623,33961,34302,34654,...
   35031,35395,35750,36112, 36479, 36849,37227,37606,37992,38385,38787,39176,39576,39980,40398,40816,41226,41641,42067,42490,42916,... 
   43388, 43840,44279, 44729,45183,45638,46104,46574,47047,47523,48007, 48489, 48976, 49470,49978,50511,51017,51530,52062,52586,53114,... 
   53650,54188,54735, 55289, 55843,56403];

K_prime = K_prime_table(find( K_prime_table >= K ));
if (length(K_prime) > 1)   %In case there is more than one value for K_prime select the value which is just greater than K
    K_prime = K_prime(1);
end